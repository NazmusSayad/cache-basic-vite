import t from"path";function w({swDest:e="sw.js",registerSwDest:i="registerSw.js",cacheSw:h=!0,preCache:n=["/sw.js","/manifest.json","/icon.ico"],preCacheRegex:s=!0,preCacheName:f="pre-cache",runtimeCacheName:u="runtime-cache"}={}){let l="PWA-caching";if(process.env.NODE_ENV!=="production")return{name:l};let j=t.join(__dirname,"./sw.js"),F=t.join(__dirname,"./registerSw.js");e=t.join("/",e),i=t.join("/",i),h&&n.push(e);let m,p;return{name:l,buildStart(){m=this.emitFile({type:"chunk",id:j}),p=this.emitFile({type:"chunk",id:F})},transformIndexHtml(d){return d.replace("</head>",`  <script type="module" src="${i}"><\/script>
  </head>`)},generateBundle(d,r){if(s instanceof RegExp){let N=Object.keys(r).filter(o=>s.test(o));n.push(...N.map(o=>t.join("/",o)))}let a=r[this.getFileName(p)],c=r[this.getFileName(m)];a.fileName=i.replace(/^\//,""),c.fileName=e.replace(/^\//,""),a.code=a.code.replace("{swDest}",e);let g=c.code.replace("[preCacheFiles]",JSON.stringify(Array.from(new Set(n)))).replace("preCache",f).replace("runtimeCache",u);c.code=g+`
// RANDOM: ${Math.random()*Math.random()+Math.random()-Math.random()/Math.random()}`}}}export{w as default};
